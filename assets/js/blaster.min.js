/*
BlasterJS is a free to use, open source BioJS component to display
BLAST alignments created by SING Group.
Copyright (C) 2016  SING - Sistemas Informaticos de Nueva Generacion

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

require=function e(t,n,l){function r(a,s){if(!n[a]){if(!t[a]){var o="function"==typeof require&&require;if(!s&&o)return o(a,!0);if(i)return i(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return r(n||e)},c,c.exports,e,t,n,l)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<l.length;a++)r(l[a]);return r}({1:[function(e,t,n){(function(e){function n(e,t,n){for(;t&&t!==Object.prototype&&(Object.getOwnPropertyNames(t).forEach(function(n){if(".class"!=n&&!e.hasOwnProperty(n)){var l=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,l)}}),!n);)t=t.__proto__;return e}var l=function(e,t,n){"function"!=typeof e&&(n=t,t=e,e=Object),t||(t={}),n||(n={});var r={name:n.name,base:e,implements:[]},i=l.clone(t);n.implements&&(Array.isArray(n.implements)?n.implements:[n.implements]).forEach(function(e){"function"==typeof e&&e.prototype&&(r.implements.push(e),l.extend(i,e.prototype))}),i.__proto__=e.prototype;var a=function(){"function"==typeof this.constructor&&this.constructor.apply(this,arguments)};return r.type=a,a.prototype=i,Object.defineProperty(a,".class.meta",{value:r,enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(i,".class",{value:a,enumerable:!1,configurable:!1,writable:!1}),n.statics&&l.extend(a,n.statics),a};l.extend=n,l.clone=function(e){return n({},e)};var r=l({constructor:function(e){this.object=e},typeOf:function(e){if(this.object instanceof e)return!0;var t=l.typeInfo(this.object);return t&&function e(t,n){for(;t;){if(t.type.prototype===n.prototype)return!0;for(var l in t.implements){var r=t.implements[l],i=r[".class.meta"];if(i){if(e(i,n))return!0}else for(var a=r.prototype;a;a=a.__proto__)if(a===n.prototype)return!0}t=t.base?t.base[".class.meta"]:void 0}return!1}(t,e)}});r.prototype.a=r.prototype.typeOf,r.prototype.an=r.prototype.typeOf,l.is=function(e){return new r(e)},l.typeInfo=function(e){var t=e.__proto__[".class"];return t?t[".class.meta"]:void 0},l.VERSION=[0,0,2],t?t.exports=l:e.Class=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){(function(){var e=Array.prototype.slice,t=Array.prototype.forEach,n=function(l){if("object"!=typeof l)throw l+" is not an object";var r=e.call(arguments,1);return t.call(r,function(e){if(e)for(var t in e)"object"==typeof e[t]&&l[t]?n.call(l,l[t],e[t]):l[t]=e[t]}),l};this.extend=n}).call(this)},{}],"biojs-vis-blasterjs":[function(e,t,n){var l=e("js-class");t.exports=l({constructor:function(t){var n=this;e("js-extend").extend(this.opt,t);var l="table tbody tr td button:hover{ text-decoration: underline;}",r=document.createElement("style");if(r.styleSheet?r.styleSheet.cssText=l:r.appendChild(document.createTextNode(l)),document.getElementsByTagName("head")[0].appendChild(r),n.opt.string){var i={target:{files:[new Blob([n.opt.string],{type:"text/plain"})]}};n._displayAlignments(i,n)}else document.getElementById(n.opt.input).addEventListener("change",function(e){n._displayAlignments(e,n)},!1)},opt:{input:"blastinput",multipleAlignments:"blast-multiple-alignments",alignmentsTable:"blast-alignments-table",singleAlignment:"blast-single-alignment"},_displayAlignments:function(e,t){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var n=e.target.files[0];if(n){var l=new FileReader;l.onload=function(e){var n=function(e){for(var t=[],n=e.split("\n"),l=0,r=0;r<n.length;r++)n[r].startsWith("Query=")&&l++;if(1==l)t.push(e);else{for(var i=0,a="",r=0;r<n.length&&(i=r,!n[r].startsWith("Query="));r++)a=a+n[r]+"\n";for(var s=0;s<l;s++){var o=a+n[i]+"\n";for(i++;void 0!==n[i]&&!n[i].startsWith("Query=");)o=o+n[i]+"\n",i++;o+="\nend\n",t.push(o)}}return t}(e.target.result),l=s(n[0]);x(n,r,0,l,a(n[0]),!0,!0,t),T(l,t);var r=l[0].hsp.length;F(l[0],t,r,0)},l.readAsText(n)}else alert("Failed to load file.")}else alert("The File APIs are not fully supported by your browser.");function r(e,t,n,l,r){this.description=e,this.length=t,this.totalScore=n,this.queryCover=l,this.hsp=r}function i(e,t,n,l,r,i,a,s,o,d,c,p){this.score=e,this.eValue=t,this.identities=n,this.positives=l,this.gaps=r,this.queryStart=i,this.query=a,this.queryEnd=s,this.comparison=o,this.subjectStart=d,this.subject=c,this.subjectEnd=p}function a(e){for(var t=e.split("\n"),n=0,l=0;l<t.length;l++)if(t[l].startsWith("Length=")){n=t[l].split("=")[1];break}return n}function s(e){e.split("\n");return function(e){for(var t=e.split("\n"),n=[],l=0;l<t.length;l++)if(t[l].startsWith(">")){for(var s=t[l].split(">")[1],d="",c=l;""==d;)t[c+=1].startsWith("Length=")?d=t[c]:s+=t[c];var p=s,u=d.split("=")[1],m=[],h=!1;do{h&&(c-=1),t[c+2].startsWith(" Features in this part of subject sequence:")&&(c+=3);var g=t[c+2].split(",")[0].replace(/\s\s+/g," ").split(" ")[3],y=t[c+2].split(",")[1].split(" ")[4],f=t[c+3].split(",")[0].split("(")[1].substr(0,t[c+3].split(",")[0].split("(")[1].length-2);if(t[0].startsWith("BLASTN"))var v="N/A",b=t[c+3].split(",")[1].split("(")[1].substr(0,t[c+3].split(",")[1].split("(")[1].length-2);else var v=t[c+3].split(",")[1].split("(")[1].substr(0,t[c+3].split(",")[1].split("(")[1].length-2),b=t[c+3].split(",")[2].split("(")[1].substr(0,t[c+3].split(",")[2].split("(")[1].length-2);("Frame"==t[c+4].split(",")[0].split(" ")[1]||t[c+4].startsWith(" Strand"))&&(c+=1);var C=t[c+5].substring(5).replace(/^\s+/g,"").split(" ")[0],E=t[c+5].substring(5).replace(/\s+/g,"").replace(/[0-9]/g,""),x=t[c+5].substring(5).replace(/^\s+/g,"").split(" ")[t[c+5].substring(5).replace(/^\s+/g,"").split(" ").length-1],w=t[c+6].replace(/^\s+/g,""),T=t[c+7].substring(5).replace(/^\s+/g,"").split(" ")[0],L=t[c+7].substring(5).replace(/\s+/g,"").replace(/[0-9]/g,""),F=t[c+7].substring(5).replace(/^\s+/g,"").split(" ")[t[c+7].substring(5).replace(/^\s+/g,"").split(" ").length-1];for(c+=9;t[c].startsWith("Query");){var A=t[c].substring(5).replace(/\s+/g,"").replace(/[0-9]/g,"");E+=A,x=t[c].substring(5).replace(/^\s+/g,"").split(" ")[t[c].substring(5).replace(/^\s+/g,"").split(" ").length-1],L+=t[c+2].substring(5).replace(/\s+/g,"").replace(/[0-9]/g,""),F=t[c+2].substring(5).replace(/^\s+/g,"").split(" ")[t[c+2].substring(5).replace(/^\s+/g,"").split(" ").length-1];var H=t[c+1].replace(/^\s+/g,"");if(A.length>H.length)for(var M=A.length-H.length,k=0;k<M;k++)H=" "+H;w+=H,c+=4}var B=new i(g,y,f,v,b,C,E,x,w,T,L,F);m.push(B),h=!0}while(t[c+1].startsWith(" Score"));for(var N=parseFloat(m[0].score),D=1;D<m.length;D++)N+=parseFloat(m[D].score);var I=new r(p,u,N.toFixed(1),o(m,a(e)),m);n.push(I)}return n}(e)}function o(e,t){for(var n=0,l=d(e),r=0;r<l.length;r++)n+=parseInt(100*(l[r].end-l[r].start+1)/t);return n}function d(e){for(var t=[],n=0;n<e.length;n++)t.push({start:parseInt(e[n].queryStart),end:parseInt(e[n].queryEnd)});return function(e){for(var t=[],n=0;n<e.length;n++){for(var l=e[n][0].start,r=e[n][0].end,i=0;i<e[n].length;i++)e[n][i].start<l&&(l=e[n][i].start),e[n][i].end>r&&(r=e[n][i].end);t.push({start:l,end:r})}return t}(function(e){e.sort(function(e,t){return e.start<t.start?-1:e.start>t.start?1:0});var t=function(e){return 0!=e.length&&(e.sort(function(e,t){return e.end<t.end?1:e.end>t.end?-1:0}),e[0].end)},n=[],l=0;n[l]=[e[0]];for(var r=1,i=e.length;r<i;r++)e[r].start>=e[r-1].start&&e[r].start<t(n[l])?n[l].push(e[r]):n[++l]=[e[r]];return n}(t))}function c(e,t){if(e)switch(t){case 1:return"<40";case 2:return"40-50";case 3:return"50-80";case 4:return"80-200";case 5:return">=200";default:return"0"}else switch(t){case 1:return">100";case 2:return"100-1";case 3:return"1-1e<sup>-2</sup>";case 4:return"1e<sup>-2</sup>-1e<sup>-5</sup>";case 5:return"<1e<sup>-5</sup>";default:return"0"}}function p(e,t){if(e)switch(t){case 1:return"#5C6D7E";case 2:return"#9B59B6";case 3:return"#5CACE2";case 4:return"#57D68D";case 5:return"#C0392B";default:return"#FFF"}else switch(t){case 1:return"#BCBCBC";case 2:return"#989898";case 3:return"#747474";case 4:return"#565656";case 5:return"#343434";default:return"#FFF"}}function u(e){var t,n=document.getElementById(e).parentElement.parentElement,l=document.getElementsByClassName("alignment-table-description");for(t=0;t<l.length;t++)l[t].style.fontWeight="normal",l[t].parentElement.parentElement.style.fontWeight="normal";n.style.fontWeight="bold",document.getElementById(e).style.fontWeight="bold"}function m(e){var t=document.createElement("div"),n=document.createElement("div"),l=document.createElement("div"),r=document.createElement("div");return t.style.marginBottom="5px",t.style.fontSize="11px",n.style.minWidth="50px",n.style.minHeight="10px",n.style.float="left",l.style.float="left",r.style.clear="both",l=function(e,t){var n=document.createElement("div");if(t>4)if(t%5==0)e=h(e,5,t/5,100);else{var l=500/(5+t%5/5);e=h(e,5,parseInt(t/5),parseInt(l));var r=parseInt(500-5*l),i=document.createElement("div");i.style.float="left",i.style.width=r+"px",i.style.textAlign="right",i.innerHTML=t,e.appendChild(i)}else e=h(e,t,1,parseInt(500/t));return n.style.clear="both",e.appendChild(n),e}(l,e),t.appendChild(n),t.appendChild(l),t.appendChild(r),t}function h(e,t,n,l){for(var r=0;r<t;r++)if(0==r){var i=l/2,a=document.createElement("div"),s=document.createElement("div");a.style.float="left",a.style.width=i+"px",a.style.textAlign="left",a.innerHTML="0",s.style.float="left",s.style.width=i+"px",s.style.textAlign="right",s.innerHTML=n*(r+1),e.appendChild(a),e.appendChild(s)}else{var o=document.createElement("div");o.style.float="left",o.style.width=l+"px",o.style.textAlign="right",o.innerHTML=n*(r+1),e.appendChild(o)}return e}function g(e,t,n,l){var r,i,a,s,o,d=document.createElement("div"),u=function(e,t){var n=document.createElement("div"),l=document.createElement("div"),r=document.createElement("div");n.style.color="#EEE",l.style.minWidth="50px",l.style.minHeight="10px",l.style.float="left",n.appendChild(l);for(var i=1;i<=5;i++){var a=document.createElement("div");a.style.minWidth="100px",a.style.textAlign="center",a.style.float="left",a.innerHTML=c(t,i).bold(),a.style.backgroundColor=p(e,i),n.appendChild(a)}return r.style.clear="both",n.appendChild(r),n}(t,n),h=(r=t,i=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),i.style.marginTop="3px",i.style.color="#5C6D7E",i.style.fontSize="10px",a.style.width="50px",a.innerHTML="QUERY".bold(),a.style.float="left",s.style.width="500px",s.style.height="10px",s.style.float="left",s.style.marginTop="2px",o.style.clear="both",s.style.backgroundColor=r?"#C0392B":"#343434",i.appendChild(a),i.appendChild(s),i.appendChild(o),i),g=m(l);return d.style.color="#5C6D7E",d.style.textAlign="center",d.style.paddingBottom="5px",d.innerHTML="COLOR KEY FOR ALIGNMENT SCORES".bold(),e.appendChild(d),e.appendChild(u),e.appendChild(h),e.appendChild(g),e}function y(e,t,n){var l=d(t.hsp),r=document.createElement("div"),i=document.createElement("div");r.style.minHeight="12px";for(var a=0;a<l.length;a++){var s=document.createElement("div"),o=document.createElement("div"),c=document.createElement("a");if(0==a){if(1==l[0].start)var p=parseInt(50+500*(l[0].start-1)/n);else p=parseInt(50+500*l[0].start/n);var m=parseInt(550-p-500*(n-l[0].end)/n)}else p=parseInt(500*(l[a].start-l[a-1].end)/n),m=parseInt(500*(l[a].end-l[a].start)/n);s.style.width=p+"px",s.style.minHeight="4px",s.style.float="left",o.style.width=m+"px",o.style.minHeight="12px",o.style.float="left",o.style.backgroundColor=e,o.onmouseout=function(){document.getElementById("defline").value=" Mouse over to show defline and scores, click to show alignments"},o.onmouseover=function(){document.getElementById("defline").value=" "+t.description+". S="+t.score+" E="+t.eValue},c.href="#"+t.description.split(" ")[0],c.onclick=function(){u(t.description.split(" ")[0])},c.appendChild(o),r.appendChild(s),r.appendChild(c)}return i.style.clear="both",r.appendChild(i),r}function f(e,t,n,l,r,i,a,s){var o=document.createElement("button");if(o.id="changeScore",o.className="btn",o.style.marginRight="10px",o.style.marginTop="5px",1==a)var d=document.createTextNode("Change scoring to E value");else d=document.createTextNode("Change scoring to Max score");return o.appendChild(d),o.onclick=function(){!function(e,t,n,l,r,i,a,s,o){s=1!=s;i.removeChild(i.childNodes[0]);var d=document.getElementById(o.opt.multipleAlignments);for(;d.firstChild;)d.removeChild(d.firstChild);x(e,t,n,l,r,a,s,o)}(e,t,n,l,r,o,i,a,s)},o}function v(e,t,n,l,r,i,a,s){var o=document.createElement("button");if(o.id="changeColors",o.className="btn",o.style.marginRight="10px",o.style.marginTop="5px",1==i)var d=document.createTextNode("Change colours to grayscale");else d=document.createTextNode("Change colours to full colored");return o.appendChild(d),o.onclick=function(){!function(e,t,n,l,r,i,a,s,o){a=1!=a;i.removeChild(i.childNodes[0]);var d=document.getElementById(o.opt.multipleAlignments);for(;d.firstChild;)d.removeChild(d.firstChild);x(e,t,n,l,r,a,s,o)}(e,t,n,l,r,o,i,a,s)},o}function b(e){var t=document.createElement("button");t.id="downloadAlignments"+e,t.className="btn",t.style.marginRight="10px",t.style.marginTop="5px";var n=document.createTextNode("Download as "+e);return t.appendChild(n),t.addEventListener("click",function(){var t,n,l,r;t=e,n=document.getElementById("blast-multiple-alignments-buttons"),l=document.getElementById("defline"),(r=document.getElementById("alignments-container")).removeChild(n),r.removeChild(l),html2canvas(r,{onrendered:function(e){document.body.appendChild(e);var i=document.createElement("a");document.body.appendChild(i),i.href="JPEG"==t?e.toDataURL("image/jpeg"):e.toDataURL("img/png"),i.download="alignments."+t.toLowerCase(),i.click(),document.body.removeChild(e),document.body.removeChild(i),r.appendChild(l),r.appendChild(n),i=document.createElement("a"),document.body.appendChild(i),i.href="#blast-multiple-alignments",i.click(),document.body.removeChild(i)}})},!1),t}function C(e){for(var t=e.split("\n"),n="",l=0;l<t.length;l++)if(t[l].startsWith("Query=")){for(n=t[l].split("=")[1],l++;!t[l].startsWith("Length=");)n=n+" "+t[l],l++;break}return n}function E(e,t,n,l,r,i,o){var d=document.createElement("select");d.style.width="430px",d.style.marginBottom="20px",d.style.color="#5C6D7E",d.style.float="right";for(var c=0;c<e.length;c++){var p=document.createElement("option");p.value=c,p.text=C(e[c]),c==n&&(p.selected="selected"),d.appendChild(p)}return d.onchange=function(){var n,l,c,p,u,m,h;n=e,l=t,c=d.value,p=r,u=i,m=o,h=s(n[c]),x(n,l,c,h,a(n[c]),p,u,m),T(h,m),l=h[0].hsp.length,F(h[0],m,l,0)},d}function x(e,t,n,l,r,i,a,s){for(var o=document.getElementById(s.opt.multipleAlignments);o.hasChildNodes();)o.removeChild(o.firstChild);var d=document.createElement("div"),c=document.createElement("div"),u=document.createElement("input"),m=v(e,t,n,l,r,i,a,s),h=f(e,t,n,l,r,i,a,s),C=b("PNG"),x=b("JPEG");if(o.style.paddingTop="20px",u.id="defline",u.name="defline",u.type="text",u.value=" Mouse over to show defline and scores, click to show alignments",u.style.width="556px",u.style.padding="1px",u.style.border=0,u.style.cursos="auto",d.id="alignments-container",d.style.border="thin solid #DDD",d.style.margin="0 auto",d.style.padding="10px",d.style.maxWidth="580px",d.style.backgroundColor="#FFF",e.length>1){var w=E(e,t,n,0,i,a,s),T=document.createElement("div"),L=document.createElement("div");L.style.clear="both",T.innerHTML="RESULTS FOR:".bold(),T.style.marginBottom="5px",T.style.color="#5C6D7E",T.style.float="left",d.appendChild(T),d.appendChild(w),d.appendChild(L)}(d=function(e,t,n,l,r){var i,a,s,o,d=document.createElement("div");d.style.paddingBottom="10px";for(var c=0;c<e.length;c++){var u=y((i=l,a=r,s=e[c].hsp[0].score,o=e[c].hsp[0].eValue,p(i,a?s<40?1:s>=40&&s<50?2:s>=50&&s<80?3:s>=80&&s<200?4:5:o>100?1:o<=100&&o>1?2:o<=1&&o>.01?3:o<=.01&&o>1e-5?4:5)),e[c],t);u.style.marginBottom="4px",d.appendChild(u)}return n.appendChild(d),n}(l,r,d=g(d,i,a,r),i,a)).appendChild(u),c.style.textAlign="right",c.id="blast-multiple-alignments-buttons",o.style.minWidth="580px",c.appendChild(h),c.appendChild(m),c.appendChild(document.createElement("br")),c.appendChild(C),c.appendChild(x),d.appendChild(c),o.appendChild(d)}function w(e){var t=document.createElement("div"),n=document.createElement("button"),l=document.createElement("button"),r=document.createElement("button");return t.style.textAlign="right",n.style.marginRight="10px",n.className="btn",n.innerHTML="Download as CSV",n.onclick=function(){!function(e){var t="data:text/csv;charset=utf-8,";t+="Description; Score; eValue; Identities; Positives; Gaps\n";for(var n=0;n<e.length;n++)t+=e[n].description,t+="; ",t+=e[n].hsp[0].score,t+="; ",t+=e[n].hsp[0].eValue,t+="; ",t+=e[n].hsp[0].identities,t+="; ",t+=e[n].hsp[0].positives,t+="; ",t+=e[n].hsp[0].gaps,t+="\n";var l=encodeURI(t),r=document.createElement("a");r.setAttribute("href",l),r.setAttribute("download","alignments-table.csv"),r.click()}(e)},r.className="btn",r.innerHTML="Download as PNG",r.onclick=function(){L("PNG")},r.style.marginRight="10px",l.className="btn",l.innerHTML="Download as JPEG",l.onclick=function(){L("JPEG")},t.appendChild(n),t.appendChild(r),t.appendChild(l),t}function T(e,t){for(var n=document.getElementById(t.opt.alignmentsTable);n.hasChildNodes();)n.removeChild(n.firstChild);var l,r,i,a,s,o,d,c,p,u=document.createElement("div"),m=w(e),h=(l=document.createElement("table"),r=document.createElement("thead"),i=document.createElement("tr"),a=document.createElement("th"),s=document.createElement("th"),o=document.createElement("th"),d=document.createElement("th"),c=document.createElement("th"),p=document.createElement("th"),l.className="table table-striped",a.innerHTML="Description".bold(),s.innerHTML="Max score".bold(),o.innerHTML="Total score".bold(),d.innerHTML="Query cover".bold(),c.innerHTML="E value".bold(),p.innerHTML="Identities".bold(),i.appendChild(a),i.appendChild(s),i.appendChild(o),i.appendChild(d),i.appendChild(c),i.appendChild(p),r.appendChild(i),l.appendChild(r),l),g=document.createElement("tbody");n.style.paddingTop="50px",u.style.backgroundColor="#FFF",u.id="blast-alignments-table-img";for(var y=0;y<e.length;y++){var f=document.createElement("tr"),v=document.createElement("td"),b=document.createElement("button");b.alignment=e[y],b.onclick=function(){t.opt.callback?t.opt.callback(this.alignment):(location.href="#"+t.opt.singleAlignment,F(this.alignment,t,this.alignment.hsp.length,0))},b.id=e[y].description.split(" ")[0],b.innerHTML=e[y].description,b.style.border=0,b.style.padding=0,b.style.display="inline",b.style.background="none",b.className="alignment-table-description",v.appendChild(b);var C=document.createElement("td");C.innerHTML=e[y].hsp[0].score;var E=document.createElement("td");E.innerHTML=e[y].totalScore;var x=document.createElement("td");x.innerHTML=e[y].queryCover+"%";var T=document.createElement("td");T.innerHTML=e[y].hsp[0].eValue;var L=document.createElement("td");L.innerHTML=e[y].hsp[0].identities+"%",f.appendChild(v),f.appendChild(C),f.appendChild(E),f.appendChild(x),f.appendChild(T),f.appendChild(L),g.appendChild(f)}h.appendChild(g),u.appendChild(h),n.appendChild(u),n.appendChild(m)}function L(e){var t,n=document.getElementsByClassName("alignment-table-description");for(t=0;t<n.length;t++)n[t].style.fontWeight="normal",n[t].parentElement.parentElement.style.fontWeight="normal";var l=document.getElementById("blast-alignments-table-img");html2canvas(l,{onrendered:function(t){document.body.appendChild(t);var n=document.createElement("a");document.body.appendChild(n),n.href="JPEG"==e?t.toDataURL("image/jpeg"):t.toDataURL("img/png"),n.download="alignments-table."+e.toLowerCase(),n.click(),document.body.removeChild(t),document.body.removeChild(n),n=document.createElement("a"),document.body.appendChild(n),n.href="#blast-alignments-table",n.click(),document.body.removeChild(n)}})}function F(e,t,n,l){for(var r=document.getElementById(t.opt.singleAlignment);r.hasChildNodes();)r.removeChild(r.firstChild);var i=document.createElement("pre"),a=document.createElement("div"),s=document.createElement("button"),o=document.createElement("button"),d=document.createElement("span"),c=document.createElement("div"),p=document.createElement("div"),u=document.createElement("div"),m=document.createElement("div"),h=document.createElement("div"),g=document.createElement("div"),y=document.createElement("div"),f=function(e,t,n){var l=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),a=document.createElement("div");l.innerHTML="Query".bold(),l.style.display="inline-block",l.style.marginRight="20px",l.style.textAlign="right",l.style.width="55px",r.innerHTML=String(t).bold(),r.style.display="inline-block",r.style.marginRight="20px",r.style.width="25px",i.innerHTML=String(n).bold(),i.style.display="inline-block",i.style.marginLeft="20px",i.style.marginRight="70px",a.appendChild(l),a.appendChild(r);for(var s=0;s<e.length;s++){var o=document.createElement("div");o.style.backgroundColor=H(e.charAt(s)),o.innerHTML=e.charAt(s).bold(),o.style.width="18px",o.style.textAlign="center",o.style.display="inline-block",a.appendChild(o)}return a.appendChild(i),a}(e.hsp[l].query,e.hsp[l].queryStart,e.hsp[l].queryEnd),v=function(e){var t=document.createElement("div"),n=document.createElement("div");n.style.minWidth="120px",n.style.minHeight="1px",n.style.display="inline-block",t.appendChild(n);for(var l=0;l<e.length;l++){var r=document.createElement("div");r.style.backgroundColor=H(e.charAt(l)),r.innerHTML=e.charAt(l).bold(),r.style.width="18px",r.style.textAlign="center",r.style.display="inline-block",t.appendChild(r)}return t}(e.hsp[l].comparison),b=function(e,t,n){var l=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),a=document.createElement("div");l.innerHTML="Subject".bold(),l.style.display="inline-block",l.style.textAlign="right",l.style.marginRight="20px",l.style.width="55px",r.style.width="25px",r.innerHTML=String(t).bold(),r.style.display="inline-block",r.style.marginRight="20px",i.innerHTML=String(n).bold(),i.style.display="inline-block",i.style.marginLeft="20px",i.style.marginRight="70px",a.appendChild(l),a.appendChild(r);for(var s=0;s<e.length;s++){var o=document.createElement("div");o.style.backgroundColor=H(e.charAt(s)),o.innerHTML=e.charAt(s).bold(),o.style.width="18px",o.style.textAlign="center",o.style.display="inline-block",a.appendChild(o)}return a.appendChild(i),a}(e.hsp[l].subject,e.hsp[l].subjectStart,e.hsp[l].subjectEnd);if(i.style.color="#2c3e50",i.style.paddingTop="25px",i.style.paddingBottom="40px",i.style.textAlign="left",i.style.fontFamily="Helvetica,Arial,sans-serif",i.id="blast-single-alignment-pre",a.style.margin="0 auto",a.style.display="table",a.style.paddingTop="30px",r.style.textAlign="right",r.style.paddingTop="50px",o.className="btn",o.innerHTML="Download as PNG",o.style.marginRight="10px",o.onclick=function(){A(e,"PNG")},s.className="btn",s.innerHTML="Download as JPEG",s.onclick=function(){A(e,"JPEG")},d.innerHTML=e.description,d.style.paddingLeft="15px",d.style.fontWeight="bold",d.style.fontSize="15px",d.style.fontFamily="Helvetica,Arial,sans-serif",c.style.paddingTop="20px",c.style.fontSize="14px",c.style.textAlign="center",c.style.fontFamily="Helvetica,Arial,sans-serif",c.style.display="table",c.style.margin="0px auto",c.style.width="100%",p.innerHTML="<b>Score:</b></br>"+e.hsp[l].score,p.style.float="left",p.style.width="20%",u.innerHTML="<b>Expect:</b></br>"+e.hsp[l].eValue,u.style.float="left",u.style.width="20%",m.innerHTML="<b>Identities:</b></br>"+e.hsp[l].identities+"%",m.style.float="left",m.style.width="20%",h.innerHTML="<b>Positives:</b></br>"+e.hsp[l].positives+"%",h.style.float="left",h.style.width="20%",g.innerHTML="<b>Gaps:</b></br>"+e.hsp[l].gaps+"%",g.style.float="left",g.style.width="20%",y.style.clear="both",c.appendChild(p),c.appendChild(u),c.appendChild(m),c.appendChild(h),c.appendChild(g),c.appendChild(y),a.appendChild(f),a.appendChild(v),a.appendChild(b),i.appendChild(d),i.appendChild(c),i.appendChild(a),r.appendChild(i),n>1){var C=document.createElement("button");if(C.className="btn",C.id="blast-single-alignment-next",C.innerHTML="Next HSP",C.style.marginTop="5px",C.style.marginRight="15px",C.style.float="right",l==n-1)var E=0;else E=l+1;C.onclick=function(){F(e,t,n,E)},i.appendChild(C)}r.appendChild(o),r.appendChild(s)}function A(e,t){var n=document.getElementById("blast-single-alignment-pre"),l=document.getElementById("blast-single-alignment-next");void 0!==l&&null!=l&&n.removeChild(l),html2canvas(n,{onrendered:function(r){document.body.appendChild(r);var i=document.createElement("a");document.body.appendChild(i),i.href="JPEG"==t?r.toDataURL("image/jpeg"):r.toDataURL("img/png"),i.download=e.description+"-alignment."+t.toLowerCase(),i.click(),document.body.removeChild(r),document.body.removeChild(i),void 0!==l&&null!=l&&n.appendChild(l),i=document.createElement("a"),document.body.appendChild(i),i.href="#blast-single-alignment",i.click(),document.body.removeChild(i)}})}function H(e){switch(e){case"A":return"#DBFA60";case"C":return"#F9FA60";case"D":return"#F9605F";case"E":return"#F9609C";case"F":return"#5FF99D";case"G":return"#F9BC5F";case"H":return"#609DF9";case"I":return"#99F95A";case"K":return"#A062FF";case"L":return"#7EF960";case"M":return"#63FF63";case"N":return"#D95DF9";case"P":return"#F9DA60";case"Q":return"#F955D8";case"R":return"#5360FB";case"S":return"#F97E60";case"T":return"#FFA563";case"V":return"#C0F86B";case"W":return"#FDD9F9";case"Y":return"#60F9DA";default:return"#FFFFFF"}}String.prototype.startsWith=function(e){return 0===this.indexOf(e)}}})},{"js-class":1,"js-extend":2}]},{},[]);